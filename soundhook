#!/bin/sh

if [ $# -lt 1 ]; then
    echo "\nOption Required"
    echo " --start : to start soundhook"
    echo " --stop  : to stop  soundhook"
    echo " --state : to check soundhook status\n"
    exit;
fi

if [ $1 = '--restart' ]; then
    echo "\n - cannot use this parameter yew :p\n\n"
    #echo "\n\n - stopping SoundHook\n\n"
    #kill -9 `ps aux | grep cron_set/watcher.sh | grep -v grep | awk {'print $2'}`
    #kill -9 `ps aux | grep cron_set/cron.sh | grep -v grep | awk {'print $2'}`
    #kill -9 `pgrep node`
    #sleep 2s
    #echo "\n\n - starting SoundHook\n\n"
    #nohup node app.js > log/node.log &
    #nohup sh cron_set/watcher.sh > log/watcher.log &
    #nohup sh cron_set/cron.sh > log/cron.log &
elif [ $1 = '--start' ]; then
    nohup sh   $PWD/cron_set/watcher.sh >  log/watcher.log &
    nohup sh   $PWD/cron_set/cron.sh    >  log/cron.log    &
    nohup node $PWD/app.js              >> log/node.log    &

    sleep 1s
    echo "\n\n -- now starting SoundHook :)\n\n"
    exit
elif [ $1 = '--state' ]; then
    echo `ps aux | grep $PWD/cron_set/watcher.sh    | grep -v grep`
    echo `ps aux | grep $PWD/cron_set/cron.sh       | grep -v grep`
    echo `ps aux | grep $PWD/app.js                 | grep -v grep`
    exit;
elif [ $1 = '--stop' ]; then
    kill -9 `ps aux | grep $PWD/cron_set/watcher.sh | grep -v grep | awk {'print $2'}`
    kill -9 `ps aux | grep $PWD/cron_set/cron.sh    | grep -v grep | awk {'print $2'}`
    kill -9 `ps aux | grep $PWD/app.js              | grep -v grep | awk {'print $2'}`
    sleep 1s
    echo "\n\n -- now stoped SoundHook \n\n"
    exit;
elif [ $1 = '--help' ]; then
    echo " Options\n"
    echo "  --start"
    echo "  --state"
    #echo "  --restart"
    echo "  --stop\n"
else
    echo "illeagal option\n"
fi

